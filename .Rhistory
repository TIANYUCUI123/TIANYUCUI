while (diff> 0.000001){
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
}
mlebeta<-lm(Y~X1+X2+X3)$coefficient
#define the old beta#
oldbeta<-mlebeta
#define alpha #
alpha<-0.00003
#define the new beta#
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
while (diff> 0.01){
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
# set up an intial value of the mlebeta
mlebeta<-lm(Y~X1+X2+X3)$coefficient
#define the old beta#
oldbeta<-mlebeta
#define alpha #
alpha<-0.00003
#define the new beta#
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
while (diff> 0.01){
print(1)
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
probit_gr  (mlebeta,X,y)
mlebeta<-lm(Y~X1+X2+X3)$coefficient
probit_gr  (mlebeta,X,y)
probit_gr  (c(0,0,0,0),X,y)
probit.null(c(0,0,0,0),X,y)
probit.nll(c(0,0,0,0),X,y)
probit.nll (c(0,0,0,0),X,y)
probit.nll
probit<-probit.nll (c(0,0,0,0),X,y)
print(probit)
l2<-probit.nll(newbeta,X,y)
n = length(y)           # sample size
k = length(mlebeta)         # number of coefficients
k
Probit_LL_g <- function (mlebeta,X,y) {
Phi = pnorm(X %*% mlebeta) # Phi is Cumulative probability
phi = dnorm(X %*% mlebeta) # phi is Probability Density
n = length(y)           # sample size
k = length(mlebeta)         # number of coefficients
g = t(matrix(rep(phi/Phi,k),nrow=n)*X) %*% y -
t(matrix(rep(phi/(1-Phi),k),nrow=n)*x) %*% (1-y)
g = -g
return(g)
}
probit_gr  (c(0,0,0,0),X,y)
mlebeta<-lm(Y~X1+X2+X3)$coefficient
#define the old beta#
oldbeta<-mlebeta
#define alpha #
alpha<-0.00003
#define the new beta#
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
while (diff> 0.01){
print(1)
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
View (newbeta)
probit.gr<- function (mlebeta,X,y) {
Phi = pnorm(X %*% mlebeta) # Phi is Cumulative probability
phi = dnorm(X %*% mlebeta) # phi is Probability Density
n = length(y)           # sample size
k = length(mlebeta)         # number of coefficients
g = t(matrix(rep(phi/Phi,k),nrow=n)*X) %*% y -
t(matrix(rep(phi/(1-Phi),k),nrow=n)*x) %*% (1-y)
g = -g
return(g)
}
probit.gr  (c(0,0,0,0),X,y)
# set up an intial value of the mlebeta
mlebeta<-lm(Y~X1+X2+X3)$coefficient
#define the old beta#
oldbeta<-mlebeta
#define alpha #
alpha<-0.00003
#define the new beta#
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
while (diff> 0.01){
print(1)
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit_gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
View (newbeta)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
while (diff> 0.01){
print(1)
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
View (newbeta)
#PROBLEM4#
probit.gr  (c(0,0,0,0),X,y)
probit.gr<- function (mlebeta,X,y) {
Phi = pnorm(X %*% mlebeta) # Phi is Cumulative probability
phi = dnorm(X %*% mlebeta) # phi is Probability Density
n = length(y)           # sample size
k = length(mlebeta)         # number of coefficients
g = t(matrix(rep(phi/Phi,k),nrow=n)*X) %*% y -
t(matrix(rep(phi/(1-Phi),k),nrow=n)*X) %*% (1-y)
g = -g
return(g)
}
probit.gr  (c(0,0,0,0),X,y)
mlebeta<-lm(Y~X1+X2+X3)$coefficient
#define the old beta#
oldbeta<-mlebeta
#define alpha #
alpha<-0.00003
#define the new beta#
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-l2-l1
while (diff> 0.01){
print(1)
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-l2-l1
}
View (newbeta)
diff<-abs(l2-l1)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(mlebeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
while (diff> 0.01){
oldbeta<-newbeta
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
print(l2)
diff<-abs(l2-l1)
}
View (newbeta)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
while (diff> 0.01){
l1<-probit.nll(oldbeta,X,y)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
oldbeta<-newbeta
diff<-abs(l2-l1)
}
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
while (diff> 0.01){
l1<-probit.nll(oldbeta,X,y)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
oldbeta<-newbeta
}
View (newbeta)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l1<-probit.nll(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
while (diff> 0.01){
l1<-probit.nll(oldbeta,X,y)
probit.gr<- function (oldbeta,X,y)
newbeta<-oldbeta-alpha*probit.gr(oldbeta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
oldbeta<-newbeta
}
View (newbeta)
beta<-mlebeta
#define alpha #
alpha<-0.00000003
#define the new beta#
newbeta<-beta-alpha*probit.gr(beta,X,y)
l1<-probit.nll(beta,X,y)
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
while (diff> 0.01){
l1<-probit.nll(beta,X,y)
probit.gr<- function (beta,X,y)
newbeta<-beta-alpha*probit.gr
l2<-probit.nll(newbeta,X,y)
diff<-abs(l2-l1)
beta<-newbeta
}
View (newbeta)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ bootnewdata[j,]<- sample(databew,size=100,replace=TRUE)
beta<- solve(t(bootnewdata$X)%*%bootnewdata$X)%*%t(bootnewdata$X)%*%bootnewdata$Y
VARe <- as.numeric(t(bootnewdata$Y-bootnewdata$X%*%beta)%*%(bootnewdata$Y-bootnewdata$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(bootnewdata$X)%*%bootnewdata$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ bootnewdata[j,]<- sample(datanew,size=100,replace=TRUE)
beta<- solve(t(bootnewdata$X)%*%bootnewdata$X)%*%t(bootnewdata$X)%*%bootnewdata$Y
VARe <- as.numeric(t(bootnewdata$Y-bootnewdata$X%*%beta)%*%(bootnewdata$Y-bootnewdata$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(bootnewdata$X)%*%bootnewdata$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=100,replace=TRUE)
beta<- solve(t(newdata$X)%*%newdata$X)%*%t(newdata$X)%*%newdata$Y
VARe <- as.numeric(t(newdata$Y-newdata$X%*%beta)%*%(newdata$Y-newdata$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(newdata$X)%*%newdata$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=10000,replace=TRUE)
beta<- solve(t(newdata$X)%*%newdata$X)%*%t(newdata$X)%*%newdata$Y
VARe <- as.numeric(t(newdata$Y-newdata$X%*%beta)%*%(newdata$Y-newdata$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(newdata$X)%*%newdata$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(newdata$X)%*%newdata$X)%*%t(newdata$X)%*%newdata$Y
VARe <- as.numeric(t(newdata$Y-newdata$X%*%beta)%*%(newdata$Y-newdata$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(newdata$X)%*%newdata$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(datanew$X)%*%datanew$X)%*%t(datanew$X)%*%datanew$Y
VARe <- as.numeric(t(datanew$Y-datanewX%*%beta)%*%(datanew$Y-datanew$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(datanew$X)%*%datanew$X)*VARe))
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(datanew$X)%*%datanew$X)%*%t(datanew$X)%*%datanew$Y
VARe <- as.numeric(t(datanew$Y-datanewX%*%beta)%*%(datanew$Y-datanew$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(datanew$X)%*%datanew$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(1,X1,X2,X3,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(datanew$X)%*%datanew$X)%*%t(datanew$X)%*%datanew$Y
VARe <- as.numeric(t(datanew$Y-datanewX%*%beta)%*%(datanew$Y-datanew$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(datanew$X)%*%datanew$X)*VARe))
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(datanew$X)%*%datanew$X)%*%t(datanew$X)%*%datanew$Y
VARe <- as.numeric(t(datanew$Y-datanewX%*%beta)%*%(datanew$Y-datanew$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(datanew$X)%*%datanew$X)*VARe))
}
View (std.boot)
X<-as.matrix(cbind(1,X1,X2,X3))
Y<-as.matrix(Y)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(datanew$X)%*%datanew$X)%*%t(datanew$X)%*%datanew$Y
VARe <- as.numeric(t(datanew$Y-datanewX%*%beta)%*%(datanew$Y-datanew$X%*%beta)/(10000-4) ) }
std.boot[i,]<- diag(sqrt(solve(t(datanew$X)%*%datanew$X)*VARe))
}
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )}
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
}
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=10000,replace=TRUE)
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )}
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
}
View (std.boot)
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
for (j in 1:10000){ datanew[j,]<- sample(datanew,size=1,replace=TRUE)
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )}
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
}
glm(y ~ X1 + X2 +X3 ,family=binomial(link="probit"))$coefficients
View (newbeta)
reglogit <- glm(y ~ X1 + X2 +X3, family=binomial(link="logit"))
summary(reglogit)
X <- cbind(1, X1, X2,X3)　
Xmean <- apply(X, 3, mean)
summary(reglogit)
# Marginal effects (ME) calculation
LAMBDA <- function(x) { 1 / (1 + exp(-x))}　# cdf of standard logistic distribution
# ME of (intercept)
ME_1  <- coef[1] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(res)))
# ME of x1
ME_x1 <- coef[2] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(res)))
# ME of x2
ME_x2 <- coef[3] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(res)))
summary(reglogit)$coefficient
ME_1  <- coef[1] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(reglogit)))
# ME of x1
ME_x1 <- coef[2] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(reglogit)))
# ME of x2
ME_x2 <- coef[3] * LAMBDA(Xmean %*% coef(reglogit)) * (1 - LAMBDA(Xmean %*% coef(reglogit)))
Xmean
Xmean <- apply(X, 3, mean)
reglogit <- glm(y ~ X1 + X2 +X3, family=binomial(link="logit"))
summary(reglogit)
X <- cbind(1, X1, X2,X3)　
Xmean <- apply(X, 3, mean)
Xmean
Xmean <- apply(X, 4, mean)
Xmean<-apply(X,2,mean)
Xmean<-apply(X,2,mean)
Xmean
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata=list()
for(j in 1:10000){
bootdata[[j,]]=datanew[sample(nrow(data), n[j], replace=TRUE), ]
}
bootdata
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata=list()
for(j in 1:10000){
bootdata[[j,]]=datanew[sample(nrow(data), n[j], replace=TRUE), ]
}
bootdata
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata=list()
for(j in 1:10000){
bootdata[[j,]]=datanew[sample(nrow(data), n[j], replace=TRUE), ]
}
bootdata
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
}
std.boot<-matrix(NA, nrow=49,ncol=4)
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata=list()
for(j in 1:10000){
bootdata[[j,]]=datanew[sample(nrow(data), n[j], replace=TRUE), ]
}
bootdata
beta<- solve(t(X)%*%X)%*%t(X)%*%Y
VARe <- as.numeric(t(Y-X%*%beta)%*%(Y-X%*%beta)/(10000-4) )
std.boot[i,]<- diag(sqrt(solve(t(X)%*%X)%*%t(X)%*%Y)*VARe)
}
View (std.boot)
probit.gr<- function (mlebeta,X,y) {
Phi = pnorm(X %*% mlebeta) # Phi is Cumulative probability
phi = dnorm(X %*% mlebeta) # phi is Probability Density
n = length(y)           # sample size
k = length(mlebeta)         # number of coefficients
g = t(matrix(rep(phi/Phi,k),nrow=n)*X) %*% y - t(matrix(rep(phi/(1-Phi),k),nrow=n)*X) %*% (1-y)
g = -g
return(g)
}
probit.gr  (c(0,0,0,0),X,y)
View (newbeta)
glm(y ~ X1 + X2 +X3 ,family=binomial(link="probit"))$coefficients
View (newbeta)
std.boot<-NA
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,1:4])%*%datanew[,1:4])%*%t(datanew[,1:4])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,1:4]-datanew[,1:4]%*%beta)%*%(datanew[,5]-datanew[,1:4]%*%beta)/(10000-4) )
std.boot[i,]<- diag(sqrt(solve(t(datanew[,1:4])%*% datanew[,1:4])*VARe))
}
View (std.boot)
beta<- solve(t(datanew[,1:4])%*%datanew[,1:4])%*%t(datanew[,1:4])%*%datanew[,5]
std.boot<-NA
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,1:4])%*%datanew[,1:4])%*%t(datanew[,1:4])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,1:4]-datanew[,1:4]%*%beta)%*%(datanew[,5]-datanew[,1:4]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,1:4])%*% datanew[,1:4])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
datanew<- cbind(X,Y)
View(datanew)
std.boot<-NA
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,c(1:4)]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,c(1:4)]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
VARe <- as.numeric(t(datanew[,5]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-NA
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,5]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
std.boot<-matrix(NA, nrow=499,ncol=4)
for (i  in 1:499){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,5]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
std.boot<-NA
for (i  in 1:499){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,5]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
std.boot<-NA
datanew<- cbind(X,Y)
for (i  in 1:49){
bootdata <- datanew[sample(nrow(datanew), 10000, replace = TRUE),]
beta<- solve(t(datanew[,c(1:4)])%*%datanew[,c(1:4)])%*%t(datanew[,c(1:4)])%*%datanew[,5]
VARe <- as.numeric(t(datanew[,5]-datanew[,c(1:4)]%*%beta)%*%(datanew[,5]-datanew[,c(1:4)]%*%beta)/(10000-4) )
std<- diag(sqrt(solve(t(datanew[,c(1:4)])%*% datanew[,c(1:4)])*VARe))
std.boot<-rbind(std.boot,std)
}
View (std.boot)
